---
{"dg-publish":true,"permalink":"//2///bs-13/"}
---

<script>
MathJax = {
  tex: {
    inlineMath: [[',
    displayMath: [['$', '$'], ['\\[', '\\]'\|'$', '$'], ['\\[', '\\]']],
    processEscapes: true,
  },
  svg: {
    fontCache: 'global'
  }
};
</script>
<script type="text/javascript" id="MathJax-script" async
  src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-svg.js">
</script>

>[!quote] 공지
>본 자료의 저작권은 **KAISTUDY**에 있습니다.

## 📌 Group 1: 역학 연구 설계와 연관성 지표 (P. 1-5)

> [!NOTE] 1페이지 – 강의 서두
> 
> 자, 여러분 반갑습니다. 오늘부터 우리는 의학 통계의 꽃이라고 할 수 있는 **로지스틱 회귀분석(Logistic Regression)**에 대해 심도 있게 다뤄볼 겁니다. 본격적인 통계 모델링에 들어가기에 앞서, 우리가 왜 이 분석을 배워야 하는지 역학 연구의 기본 설계부터 복습해 봅시다.
> 
> > [!INFO] 🧬 학습 개요
> > * **과목명:** 의과학 생체통계학 (Biostatistics in Medical Science) 
> > * **주제:** 로지스틱 회귀분석 (Logistic Regression Analysis) 
> > * **핵심 목표:** 질병 발생에 영향을 미치는 **위험 요인**을 분석하고 **발생 확률**을 예측하는 법을 익히는 것.

---

> [!NOTE] 2페이지 – 코호트 연구(Cohort Study)의 설계
> 
> 먼저 **코호트 연구**부터 보겠습니다. 이 그림은 여러분이 역학 시간에 질리도록 봤을 설계도죠. 
> 
> > [!IMPORTANT] 💡 코호트 연구의 핵심 메커니즘
> > 1. **시작점:** 현재 질병이 없는 집단을 **노출군**과 **비노출군**으로 나눕니다.
> > 2. **방향성:** **시간**의 흐름에 따라 미래로 나아가는 **전향적(Prospective)** 구조입니다.
> > 3. **결과:** 일정 기간 추적 조사 후, 각 군에서 실제 **질병 발생(+)** 여부를 확인합니다.
> 
> 자, 이렇게 '발생'을 직접 관찰하기 때문에 우리는 무엇을 구할 수 있을까요? 바로 다음 장에서 배울 '발생률'입니다.

---

> [!NOTE] 3페이지 – 상대위험도(Relative Risk, RR)의 계산
> 
> 코호트 연구의 결론은 결국 **상대위험도(RR)**로 귀결됩니다. 표 5-6-2를 잘 보세요.
> 
> > [!LIST] 📝 상대위험도 산출 공식
> > * **노출군 발생률:** $\frac{a}{a+b}$ 
> > * **비노출군 발생률:** $\frac{c}{c+d}$ 
> > * **상대위험도(RR):** $\frac{\text{노출군의 발생률}}{\text{비노출군의 발생률}} = \frac{a/(a+b)}{c/(c+d)}$ 
> 
> > [!TIP] ⭐️ 족보 포인트
> > 코호트 연구는 특정 요인에 노출된 사람과 그렇지 않은 사람의 **질병 발생 확률**을 직접 비교할 수 있는 아주 강력한 설계입니다. 하지만 시간과 비용이 많이 들죠. 그래서 우리는 다음 페이지의 설계를 고민하게 됩니다.

---

> [!NOTE] 4페이지 – 환자대조군 연구(Case-control Study)의 설계
> 
> 이번에는 **환자대조군 연구**입니다. 코호트와는 완전히 반대 방향이죠.
> 
> > [!IMPORTANT] 💡 환자대조군 연구의 핵심 메커니즘
> > 1. **시작점:** 이미 병에 걸린 **환자군(Case)**과 걸리지 않은 **대조군(Control)**을 먼저 섭외합니다.
> > 2. **방향성:** 이들이 과거에 위험 요인에 **노출(E+)**되었는지, **비노출(E-)**되었는지를 거꾸로 조사하는 **후향적(Retrospective)** 구조입니다.
> 
> 이 설계는 질병 발생률을 직접 구할 수 없습니다. 이미 환자를 뽑아놓고 시작하니까요. 그래서 RR 대신 사용하는 지표가 바로 '교차비'입니다.

---

> [!NOTE] 5페이지 – 교차비(Odds Ratio, OR)의 개념
> 
> 자, 오늘의 주인공인 로지스틱 회귀분석과 직결되는 개념, **교차비(OR)**입니다. 
> 
> > [!INFO] 🧬 Odds와 Odds Ratio의 정의
> > * **Odds (승산):** 어떤 사건이 **일어날 확률(p)**을 **일어나지 않을 확률(1-p)**로 나눈 값 ($\text{Odds} = \frac{p}{1-p}$) 
> > * **Odds Ratio (교차비):** 환자군의 Odds를 대조군의 Odds로 나눈 비율 
> 
> > [!IMPORTANT] 💡 교차비 산출 공식 (AD/BC)
> > * **환자군 Odds:** $A/C$ 
> > * **대조군 Odds:** $B/D$ 
> > * **최종 OR:** $\frac{A/C}{B/D} = \frac{AD}{BC}$ 
> 
> > [!TIP] ⭐️ 족보 포인트
> > 로지스틱 회귀분석의 결과값은 보통 이 **OR** 형태로 해석하게 됩니다. 특히 질병의 유병률이 낮을 때는 **OR이 RR의 근사치**로 사용될 수 있다는 점을 꼭 기억하세요.

---

## 📌 Group 2: 로지스틱 회귀의 원리와 수학적 모델링 (P. 6-13)

> [!NOTE] 6페이지 – 로지스틱 회귀분석의 정의
> 
> 자, 이제 본격적으로 **로지스틱 회귀분석(Logistic Regression)**의 본체로 들어갑니다. 일반적인 선형 회귀와 가장 큰 차이점이 뭘까요? 바로 **종속변수**의 모양입니다.
> 
> > [!INFO] 🧬 변수의 정의
> > * **종속변인(Y):** 반드시 **이분변수(Binary, 0 or 1)**여야 합니다. (예: 질환 있음=1, 없음=0) 
> > * **독립변인(X):** 연속형, 범주형 등 **척도에 상관없이** 모두 사용할 수 있습니다.
> 
> > [!IMPORTANT] 💡 분석의 목적
> > 단순히 관계를 보는 게 아니라, 특정 사건이 발생할 **확률(Probability)**을 예측하고 **로지스틱 곡선**에 적합시키는 것이 핵심입니다.
> 
> 자, 예를 들어 연령군에 따라 관상동맥성 심질환(CHD)이 생길 확률이 어떻게 변하는지 살펴볼까요? 

---

> [!NOTE] 7-8페이지 – 데이터의 흐름과 시각화
> 
> 앞서 말한 예시를 실제 수치로 봅시다. 7페이지 표와 8페이지 그래프를 연결해서 이해해야 합니다.
> 
> > [!LIST] 📝 연령군별 CHD 발생 특징
> > * **20대:** 발생 비율이 **0.10**에 불과합니다.
> > * **60대:** 발생 비율이 **0.80**까지 치솟습니다.
> > * **경향성:** 연령(X)이 증가함에 따라 질환 확률(Y)이 **비선형적**으로 증가하는 것을 볼 수 있습니다.
> 
> 이 데이터를 좌표평면에 찍어보면, 8페이지처럼 완만한 **S자 형태(S-shape)**의 흐름이 나타납니다. 직선이 아니라 곡선이라는 점에 주목하세요.

---

> [!NOTE] 9-10페이지 – 로지스틱 곡선의 함수 (Sigmoid)
> 
> 왜 직선이 아니라 곡선일까요? 확률은 **0과 1 사이**에만 존재해야 하기 때문입니다. 이를 수학적으로 구현한 것이 바로 **로지스틱 함수**입니다.
> 
> > [!IMPORTANT] 💡 로지스틱 함수 공식
> > $$f(z) = \frac{1}{1 + e^{-z}} = \frac{e^{z}}{1 + e^{z}}$$ 
> 
> > [!WARNING] ⚠️ 함수의 특성
> > * $z$값이 **$-\infty$**로 가면 확률은 **0**에 수렴합니다.
> > * $z$값이 **$+\infty$**로 가면 확률은 **1**에 수렴합니다.
> > * $z=0$일 때, 정확히 **0.5(50%)**의 확률을 갖습니다.
> 
> 이 아름다운 곡선은 1838년 **Verhulst**가 인구 성장 모델을 보정하기 위해 제안한 모델에서 유래되었습니다.

---

> [!NOTE] 12페이지 – 의학 연구에서의 적용
> 
> 자, 이제 이 수학을 의학에 적용해 봅시다. 우리가 궁금한 건 '이 환자가 병에 걸릴 확률'이죠.
> 
> > [!INFO] 🧬 모델의 구성 요소
> > * **$f(z)$:** 특정 조건(z)을 가진 개인이 **질병을 얻을 확률(P)**입니다.
> > * **$Z$:** 우리가 가진 여러 **독립변수들의 선형 조합**입니다.
> 
> > [!LIST] 📝 선형 예측식 (Linear Predictor)
> > $$z = \alpha + \beta_{1}X_{1} + \beta_{2}X_{2} + \dots + \beta_{k}X_{k} + \epsilon$$ 
> 
> 예를 들어, $z$에 **연령, 성별, 흡연 여부**를 다 집어넣어서 계산된 값이 최종적으로 질병 확률 $P$로 변환되는 과정인 겁니다.

---

> [!NOTE] 13페이지 – 로짓(Logit) 변환과 교차비(OR)
> 
> 이 페이지가 오늘 강의의 **하이라이트**이자 시험에 반드시 나오는 부분입니다. 별표 치세요.
> 
> > [!IMPORTANT] 🔑 Logit 변환: 확률을 직선으로!
> > 확률 $P$를 그대로 쓰면 곡선이라 다루기 어렵죠? 그래서 **Odds에 자연로그(Ln)**를 취합니다.
> > $$Ln(\text{Odds}) = Ln\left(\frac{P}{1-P}\right) = z = \alpha + \beta_{1}X_{1} + \dots$$ 
> > 이를 **로짓 변환(Logit Transformation)**이라고 부릅니다.
> 
> > [!TIP] ⭐️ 족보 포인트: 회귀계수($\beta$)의 해석
> > * 로지스틱 회귀에서 구한 계수 **$\beta_{1}$**은 **$Ln(\text{Odds Ratio})$**와 같습니다.
> > * 따라서 우리가 진짜 궁금한 **교차비(OR)**를 구하려면 계수에 **지수함수($Exp$)**를 취해야 합니다.
> > * **$\text{OR} = e^{\beta}$** 
> 
> "독립변수 $X$가 1단위 증가할 때, 질병의 Odds가 $e^{\beta}$배 증가한다"라고 해석하는 거죠. 이해되시죠?

---

## 📌 Group 3: 실전 분석 및 SPSS 실습 (P. 14-22)

> [!NOTE] 14페이지 – 로지스틱 회귀분석의 실제 사례 (비알콜성 지방간)
> 
> 자, 이론을 배웠으니 실제 논문 데이터를 봅시다. **비알콜성 지방간질환(NAFLD)**과 연관된 인자들을 분석한 표입니다.
> 
> > [!quote] 🩺 임상 데이터 해석: Independent factors
> > * **BMI ($kg/m^{2}$):** **OR 1.378**로, BMI가 1 증가할 때마다 지방간 위험이 약 **38%**씩 높아집니다.
> > * **당뇨(DM):** **OR 2.950**입니다. 당뇨가 있으면 없는 사람보다 위험도가 약 **3배**나 높다는 뜻이죠.
> > * **고중성지방혈증:** **OR 1.815**로 나타나네요.
> 
> 이처럼 **p-value**가 0.05보다 작으면서 **95% CI(신뢰구간)**가 1을 포함하지 않는 변수들이 '독립적인 위험 인자'가 됩니다.

---

> [!NOTE] 15-16페이지 – SPSS 실습 데이터 설정 (sample.sav)
> 
> 이제 직접 돌려볼 시간입니다. **sample.sav** 파일을 열어보세요. 허혈성 뇌혈관질환자(환자군)와 대조군을 비교하는 자료입니다.
> 
> > [!IMPORTANT] 💡 주요 변수 마스터 코딩
> > * **dx (종속변수):** **뇌혈관 질환 여부**입니다. 대조군은 **0**, 질환자는 **1**로 코딩되어 있죠.
> > * **sbp/dbp:** 수축기/이완기 혈압입니다.
> > * **smoke/drink:** 흡연 및 음주 여부입니다.
> 
> 이 데이터를 가지고 우리가 먼저 할 일은 연속형인 혈압 데이터를 의미 있는 그룹으로 나누는 것입니다.

---

> [!NOTE] 17-19페이지 – 변수 계산 및 리코딩 (혈압 분류)
> 
> 의학적으로 혈압은 단순히 수치보다 **단계별 분류**가 중요합니다. **JNC-7 기준**에 따라 '혈압수준' 변수를 새로 만듭니다.
> 
> > [!LIST] 📝 혈압 수준별 코딩 (SPSS Syntax)
> > 1. **Normal (1):** sbp < 120 **AND** dbp < 80 
> > 2. **Prehypertension (2):** sbp 120-139 **OR** dbp 80-89 
> > 3. **Stage 1 HTN (3):** sbp 140-159 **OR** dbp 90-99 
> > 4. **Stage 2 HTN (4):** sbp ≥ 160 **OR** dbp ≥ 100 
> 
> > [!WARNING] ⚠️ 주의사항
> > SPSS에서 **'변수 계산'** 메뉴를 사용할 때, **'케이스 조건'**에서 AND(&)와 OR(|) 조건을 정확히 입력해야 에러가 나지 않습니다.

---

> [!NOTE] 20-21페이지 – 이분형 로지스틱 회귀분석 실행
> 
> 이제 메뉴에서 **[분석] -> [회귀분석] -> [이분형 로지스틱]**을 클릭하세요.
> 
> > [!IMPORTANT] 🔑 분석 세팅 값
> > * **종속변수:** **dx** (뇌혈관 질환 여부) 
> > * **공변량:** **혈압수준** (우리가 방금 만든 변수) 
> > * **범주형 버튼:** '혈압수준'을 넣고 **참조범주**를 '처음'(Normal)으로 설정하세요.
> > * **옵션 버튼:** 반드시 **'exp(B)에 대한 신뢰구간(95%)'**을 체크해야 OR 값을 얻을 수 있습니다.

---

> [!NOTE] 22페이지 – 결과 해석 (Variables in the Equation)
> 
> 가장 중요한 결과 표인 **'Variables in the Equation'**을 봅시다. 분석이 아주 잘 되었네요.
> 
> > [!TIP] ⭐️ 족보 포인트: 혈압과 뇌졸중의 관계
> > * **Normal(ref.):** 비교의 기준입니다.
> > * **Stage 2 HTN:** **Exp(B)**, 즉 **OR** 값이 무려 **63.786**입니다! 
> > * **해석:** 정상 혈압인 사람에 비해 2단계 고혈압 환자는 뇌졸중 발생 위험(Odds)이 **약 63.8배**나 높다는 충격적인 결과입니다.
> 
> > [!INFO] 🧬 모델 적합도 확인
> > **Omnibus Tests**의 p-value가 **.000**이므로 이 회귀 모델은 매우 유의미하며, 전체 예측 정확도는 **81.2%**입니다.
>
>  자, 단변량 분석 결과가 이렇게 명확하게 나왔습니다. 하지만 실제 환자는 혈압만 높은 게 아니죠? 비만도도 있고 나이도 많을 겁니다. 이 모든 걸 한꺼번에 넣고 돌리는 '다변량 모형'을 다음 장에서 만들어봅시다.

---
## 📌 Group 4: 다변량 모형 구축 및 데이터 가공 (P. 23-27)

> [!NOTE] 23-24페이지 – 다변량 로지스틱 회귀모형 설정
> 
> 자, 이제 여러 위험 요인을 동시에 고려하는 **다변량 모형(Multivariate Model)**을 만들어 봅시다.  단순히 혈압만 보는 게 아니라, 다른 변수들의 영향을 통제했을 때의 순수한 효과를 찾는 과정입니다. 
> 
> > [!IMPORTANT] 💡 다변량 분석 세팅 (SPSS)
> > * **종속변수:** **dx** (뇌혈관 질환 여부) 
> > * **공변량(Covariates):** **혈압수준**, **비만수준(bmi_g)**, **콜레스테롤(chol)**, **흡연여부(smoke)**, **음주여부(drink)**, **연령(old)**을 모두 투입합니다. 
> > * **범주형 변수 지정:** **혈압수준**, **bmi_g**, **smoke**, **drink**는 범주형이므로 반드시 '범주형' 버튼에서 지정해 주어야 합니다. 
> 
> > [!WARNING] ⚠️ 분석 옵션 필수 체크
> > 반드시 **[옵션]** 메뉴에서 **'exp(B)에 대한 신뢰구간'**을 체크해야 우리가 해석할 수 있는 **Odds Ratio(OR)**와 그 유의성을 확인할 수 있습니다. 

---

> [!NOTE] 25페이지 – 데이터 가공: BMI 계산 공식
> 
> 분석을 하려는데 자료에 **BMI**나 **비만 그룹** 변수가 없다면 어떻게 할까요? 직접 만들어야 합니다.  SPSS의 **'변수 계산'** 기능을 활용합니다. 
> 
> > [!LIST] 📝 BMI 산출 공식 (Syntax)
> > * **공식:** `COMPUTE bmi = wt / ((ht / 100)**2).` 
> > * **설명:** **체중(kg)**을 **신장(m)의 제곱**으로 나눕니다.  자료의 키가 cm 단위라면 반드시 **100**으로 나누어 미터(m)로 변환해야 함을 잊지 마세요. 

---

> [!NOTE] 26-27페이지 – 연속변수의 범주화 (BMI Grouping)
> 
> 계산된 연속형 BMI를 그대로 쓸 수도 있지만, 임상적 해석을 위해 **범주형(bmi_g)**으로 변환하는 경우가 많습니다. 
> 
> > [!IMPORTANT] 🔑 BMI 그룹화 기준
> > 1. **저체중 (1):** BMI < **18.5** 
> > 2. **정상 (2):** **18.5** ≤ BMI < **23** 
> > 3. **과체중 (3):** **23** ≤ BMI < **25** 
> > 4. **비만 (4):** BMI ≥ **25** 
> 
> > [!TIP] ⭐️ 실무 포인트
> > SPSS **'변수 계산'** 창에서 **[조건]** 버튼을 눌러 각 범위에 해당하는 케이스만 선택하여 값을 부여하면 됩니다.  이 과정이 정확해야 최종 로지스틱 분석 결과도 신뢰할 수 있습니다. 

, ',
    displayMath: [['$$', '$$'], ['\\[', '\\]']],
    processEscapes: true,
  },
  svg: {
    fontCache: 'global'
  }
};
</script>
<script type="text/javascript" id="MathJax-script" async
  src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-svg.js">
</script>

>[!quote] 공지
>본 자료의 저작권은 **KAISTUDY**에 있습니다.

## 📌 Group 1: 역학 연구 설계와 연관성 지표 (P. 1-5)

> [!NOTE] 1페이지 – 강의 서두
> 
> 자, 여러분 반갑습니다. 오늘부터 우리는 의학 통계의 꽃이라고 할 수 있는 **로지스틱 회귀분석(Logistic Regression)**에 대해 심도 있게 다뤄볼 겁니다. 본격적인 통계 모델링에 들어가기에 앞서, 우리가 왜 이 분석을 배워야 하는지 역학 연구의 기본 설계부터 복습해 봅시다.
> 
> > [!INFO] 🧬 학습 개요
> > * **과목명:** 의과학 생체통계학 (Biostatistics in Medical Science) 
> > * **주제:** 로지스틱 회귀분석 (Logistic Regression Analysis) 
> > * **핵심 목표:** 질병 발생에 영향을 미치는 **위험 요인**을 분석하고 **발생 확률**을 예측하는 법을 익히는 것.

---

> [!NOTE] 2페이지 – 코호트 연구(Cohort Study)의 설계
> 
> 먼저 **코호트 연구**부터 보겠습니다. 이 그림은 여러분이 역학 시간에 질리도록 봤을 설계도죠. 
> 
> > [!IMPORTANT] 💡 코호트 연구의 핵심 메커니즘
> > 1. **시작점:** 현재 질병이 없는 집단을 **노출군**과 **비노출군**으로 나눕니다.
> > 2. **방향성:** **시간**의 흐름에 따라 미래로 나아가는 **전향적(Prospective)** 구조입니다.
> > 3. **결과:** 일정 기간 추적 조사 후, 각 군에서 실제 **질병 발생(+)** 여부를 확인합니다.
> 
> 자, 이렇게 '발생'을 직접 관찰하기 때문에 우리는 무엇을 구할 수 있을까요? 바로 다음 장에서 배울 '발생률'입니다.

---

> [!NOTE] 3페이지 – 상대위험도(Relative Risk, RR)의 계산
> 
> 코호트 연구의 결론은 결국 **상대위험도(RR)**로 귀결됩니다. 표 5-6-2를 잘 보세요.
> 
> > [!LIST] 📝 상대위험도 산출 공식
> > * **노출군 발생률:** $\frac{a}{a+b}$ 
> > * **비노출군 발생률:** $\frac{c}{c+d}$ 
> > * **상대위험도(RR):** $\frac{\text{노출군의 발생률}}{\text{비노출군의 발생률}} = \frac{a/(a+b)}{c/(c+d)}$ 
> 
> > [!TIP] ⭐️ 족보 포인트
> > 코호트 연구는 특정 요인에 노출된 사람과 그렇지 않은 사람의 **질병 발생 확률**을 직접 비교할 수 있는 아주 강력한 설계입니다. 하지만 시간과 비용이 많이 들죠. 그래서 우리는 다음 페이지의 설계를 고민하게 됩니다.

---

> [!NOTE] 4페이지 – 환자대조군 연구(Case-control Study)의 설계
> 
> 이번에는 **환자대조군 연구**입니다. 코호트와는 완전히 반대 방향이죠.
> 
> > [!IMPORTANT] 💡 환자대조군 연구의 핵심 메커니즘
> > 1. **시작점:** 이미 병에 걸린 **환자군(Case)**과 걸리지 않은 **대조군(Control)**을 먼저 섭외합니다.
> > 2. **방향성:** 이들이 과거에 위험 요인에 **노출(E+)**되었는지, **비노출(E-)**되었는지를 거꾸로 조사하는 **후향적(Retrospective)** 구조입니다.
> 
> 이 설계는 질병 발생률을 직접 구할 수 없습니다. 이미 환자를 뽑아놓고 시작하니까요. 그래서 RR 대신 사용하는 지표가 바로 '교차비'입니다.

---

> [!NOTE] 5페이지 – 교차비(Odds Ratio, OR)의 개념
> 
> 자, 오늘의 주인공인 로지스틱 회귀분석과 직결되는 개념, **교차비(OR)**입니다. 
> 
> > [!INFO] 🧬 Odds와 Odds Ratio의 정의
> > * **Odds (승산):** 어떤 사건이 **일어날 확률(p)**을 **일어나지 않을 확률(1-p)**로 나눈 값 ($\text{Odds} = \frac{p}{1-p}$) 
> > * **Odds Ratio (교차비):** 환자군의 Odds를 대조군의 Odds로 나눈 비율 
> 
> > [!IMPORTANT] 💡 교차비 산출 공식 (AD/BC)
> > * **환자군 Odds:** $A/C$ 
> > * **대조군 Odds:** $B/D$ 
> > * **최종 OR:** $\frac{A/C}{B/D} = \frac{AD}{BC}$ 
> 
> > [!TIP] ⭐️ 족보 포인트
> > 로지스틱 회귀분석의 결과값은 보통 이 **OR** 형태로 해석하게 됩니다. 특히 질병의 유병률이 낮을 때는 **OR이 RR의 근사치**로 사용될 수 있다는 점을 꼭 기억하세요.

---

## 📌 Group 2: 로지스틱 회귀의 원리와 수학적 모델링 (P. 6-13)

> [!NOTE] 6페이지 – 로지스틱 회귀분석의 정의
> 
> 자, 이제 본격적으로 **로지스틱 회귀분석(Logistic Regression)**의 본체로 들어갑니다. 일반적인 선형 회귀와 가장 큰 차이점이 뭘까요? 바로 **종속변수**의 모양입니다.
> 
> > [!INFO] 🧬 변수의 정의
> > * **종속변인(Y):** 반드시 **이분변수(Binary, 0 or 1)**여야 합니다. (예: 질환 있음=1, 없음=0) 
> > * **독립변인(X):** 연속형, 범주형 등 **척도에 상관없이** 모두 사용할 수 있습니다.
> 
> > [!IMPORTANT] 💡 분석의 목적
> > 단순히 관계를 보는 게 아니라, 특정 사건이 발생할 **확률(Probability)**을 예측하고 **로지스틱 곡선**에 적합시키는 것이 핵심입니다.
> 
> 자, 예를 들어 연령군에 따라 관상동맥성 심질환(CHD)이 생길 확률이 어떻게 변하는지 살펴볼까요? 

---

> [!NOTE] 7-8페이지 – 데이터의 흐름과 시각화
> 
> 앞서 말한 예시를 실제 수치로 봅시다. 7페이지 표와 8페이지 그래프를 연결해서 이해해야 합니다.
> 
> > [!LIST] 📝 연령군별 CHD 발생 특징
> > * **20대:** 발생 비율이 **0.10**에 불과합니다.
> > * **60대:** 발생 비율이 **0.80**까지 치솟습니다.
> > * **경향성:** 연령(X)이 증가함에 따라 질환 확률(Y)이 **비선형적**으로 증가하는 것을 볼 수 있습니다.
> 
> 이 데이터를 좌표평면에 찍어보면, 8페이지처럼 완만한 **S자 형태(S-shape)**의 흐름이 나타납니다. 직선이 아니라 곡선이라는 점에 주목하세요.

---

> [!NOTE] 9-10페이지 – 로지스틱 곡선의 함수 (Sigmoid)
> 
> 왜 직선이 아니라 곡선일까요? 확률은 **0과 1 사이**에만 존재해야 하기 때문입니다. 이를 수학적으로 구현한 것이 바로 **로지스틱 함수**입니다.
> 
> > [!IMPORTANT] 💡 로지스틱 함수 공식
> > $$f(z) = \frac{1}{1 + e^{-z}} = \frac{e^{z}}{1 + e^{z}}$$ 
> 
> > [!WARNING] ⚠️ 함수의 특성
> > * $z$값이 **$-\infty$**로 가면 확률은 **0**에 수렴합니다.
> > * $z$값이 **$+\infty$**로 가면 확률은 **1**에 수렴합니다.
> > * $z=0$일 때, 정확히 **0.5(50%)**의 확률을 갖습니다.
> 
> 이 아름다운 곡선은 1838년 **Verhulst**가 인구 성장 모델을 보정하기 위해 제안한 모델에서 유래되었습니다.

---

> [!NOTE] 12페이지 – 의학 연구에서의 적용
> 
> 자, 이제 이 수학을 의학에 적용해 봅시다. 우리가 궁금한 건 '이 환자가 병에 걸릴 확률'이죠.
> 
> > [!INFO] 🧬 모델의 구성 요소
> > * **$f(z)$:** 특정 조건(z)을 가진 개인이 **질병을 얻을 확률(P)**입니다.
> > * **$Z$:** 우리가 가진 여러 **독립변수들의 선형 조합**입니다.
> 
> > [!LIST] 📝 선형 예측식 (Linear Predictor)
> > $$z = \alpha + \beta_{1}X_{1} + \beta_{2}X_{2} + \dots + \beta_{k}X_{k} + \epsilon$$ 
> 
> 예를 들어, $z$에 **연령, 성별, 흡연 여부**를 다 집어넣어서 계산된 값이 최종적으로 질병 확률 $P$로 변환되는 과정인 겁니다.

---

> [!NOTE] 13페이지 – 로짓(Logit) 변환과 교차비(OR)
> 
> 이 페이지가 오늘 강의의 **하이라이트**이자 시험에 반드시 나오는 부분입니다. 별표 치세요.
> 
> > [!IMPORTANT] 🔑 Logit 변환: 확률을 직선으로!
> > 확률 $P$를 그대로 쓰면 곡선이라 다루기 어렵죠? 그래서 **Odds에 자연로그(Ln)**를 취합니다.
> > $$Ln(\text{Odds}) = Ln\left(\frac{P}{1-P}\right) = z = \alpha + \beta_{1}X_{1} + \dots$$ 
> > 이를 **로짓 변환(Logit Transformation)**이라고 부릅니다.
> 
> > [!TIP] ⭐️ 족보 포인트: 회귀계수($\beta$)의 해석
> > * 로지스틱 회귀에서 구한 계수 **$\beta_{1}$**은 **$Ln(\text{Odds Ratio})$**와 같습니다.
> > * 따라서 우리가 진짜 궁금한 **교차비(OR)**를 구하려면 계수에 **지수함수($Exp$)**를 취해야 합니다.
> > * **$\text{OR} = e^{\beta}$** 
> 
> "독립변수 $X$가 1단위 증가할 때, 질병의 Odds가 $e^{\beta}$배 증가한다"라고 해석하는 거죠. 이해되시죠?

---

## 📌 Group 3: 실전 분석 및 SPSS 실습 (P. 14-22)

> [!NOTE] 14페이지 – 로지스틱 회귀분석의 실제 사례 (비알콜성 지방간)
> 
> 자, 이론을 배웠으니 실제 논문 데이터를 봅시다. **비알콜성 지방간질환(NAFLD)**과 연관된 인자들을 분석한 표입니다.
> 
> > [!quote] 🩺 임상 데이터 해석: Independent factors
> > * **BMI ($kg/m^{2}$):** **OR 1.378**로, BMI가 1 증가할 때마다 지방간 위험이 약 **38%**씩 높아집니다.
> > * **당뇨(DM):** **OR 2.950**입니다. 당뇨가 있으면 없는 사람보다 위험도가 약 **3배**나 높다는 뜻이죠.
> > * **고중성지방혈증:** **OR 1.815**로 나타나네요.
> 
> 이처럼 **p-value**가 0.05보다 작으면서 **95% CI(신뢰구간)**가 1을 포함하지 않는 변수들이 '독립적인 위험 인자'가 됩니다.

---

> [!NOTE] 15-16페이지 – SPSS 실습 데이터 설정 (sample.sav)
> 
> 이제 직접 돌려볼 시간입니다. **sample.sav** 파일을 열어보세요. 허혈성 뇌혈관질환자(환자군)와 대조군을 비교하는 자료입니다.
> 
> > [!IMPORTANT] 💡 주요 변수 마스터 코딩
> > * **dx (종속변수):** **뇌혈관 질환 여부**입니다. 대조군은 **0**, 질환자는 **1**로 코딩되어 있죠.
> > * **sbp/dbp:** 수축기/이완기 혈압입니다.
> > * **smoke/drink:** 흡연 및 음주 여부입니다.
> 
> 이 데이터를 가지고 우리가 먼저 할 일은 연속형인 혈압 데이터를 의미 있는 그룹으로 나누는 것입니다.

---

> [!NOTE] 17-19페이지 – 변수 계산 및 리코딩 (혈압 분류)
> 
> 의학적으로 혈압은 단순히 수치보다 **단계별 분류**가 중요합니다. **JNC-7 기준**에 따라 '혈압수준' 변수를 새로 만듭니다.
> 
> > [!LIST] 📝 혈압 수준별 코딩 (SPSS Syntax)
> > 1. **Normal (1):** sbp < 120 **AND** dbp < 80 
> > 2. **Prehypertension (2):** sbp 120-139 **OR** dbp 80-89 
> > 3. **Stage 1 HTN (3):** sbp 140-159 **OR** dbp 90-99 
> > 4. **Stage 2 HTN (4):** sbp ≥ 160 **OR** dbp ≥ 100 
> 
> > [!WARNING] ⚠️ 주의사항
> > SPSS에서 **'변수 계산'** 메뉴를 사용할 때, **'케이스 조건'**에서 AND(&)와 OR(|) 조건을 정확히 입력해야 에러가 나지 않습니다.

---

> [!NOTE] 20-21페이지 – 이분형 로지스틱 회귀분석 실행
> 
> 이제 메뉴에서 **[분석] -> [회귀분석] -> [이분형 로지스틱]**을 클릭하세요.
> 
> > [!IMPORTANT] 🔑 분석 세팅 값
> > * **종속변수:** **dx** (뇌혈관 질환 여부) 
> > * **공변량:** **혈압수준** (우리가 방금 만든 변수) 
> > * **범주형 버튼:** '혈압수준'을 넣고 **참조범주**를 '처음'(Normal)으로 설정하세요.
> > * **옵션 버튼:** 반드시 **'exp(B)에 대한 신뢰구간(95%)'**을 체크해야 OR 값을 얻을 수 있습니다.

---

> [!NOTE] 22페이지 – 결과 해석 (Variables in the Equation)
> 
> 가장 중요한 결과 표인 **'Variables in the Equation'**을 봅시다. 분석이 아주 잘 되었네요.
> 
> > [!TIP] ⭐️ 족보 포인트: 혈압과 뇌졸중의 관계
> > * **Normal(ref.):** 비교의 기준입니다.
> > * **Stage 2 HTN:** **Exp(B)**, 즉 **OR** 값이 무려 **63.786**입니다! 
> > * **해석:** 정상 혈압인 사람에 비해 2단계 고혈압 환자는 뇌졸중 발생 위험(Odds)이 **약 63.8배**나 높다는 충격적인 결과입니다.
> 
> > [!INFO] 🧬 모델 적합도 확인
> > **Omnibus Tests**의 p-value가 **.000**이므로 이 회귀 모델은 매우 유의미하며, 전체 예측 정확도는 **81.2%**입니다.
>
>  자, 단변량 분석 결과가 이렇게 명확하게 나왔습니다. 하지만 실제 환자는 혈압만 높은 게 아니죠? 비만도도 있고 나이도 많을 겁니다. 이 모든 걸 한꺼번에 넣고 돌리는 '다변량 모형'을 다음 장에서 만들어봅시다.

---
## 📌 Group 4: 다변량 모형 구축 및 데이터 가공 (P. 23-27)

> [!NOTE] 23-24페이지 – 다변량 로지스틱 회귀모형 설정
> 
> 자, 이제 여러 위험 요인을 동시에 고려하는 **다변량 모형(Multivariate Model)**을 만들어 봅시다.  단순히 혈압만 보는 게 아니라, 다른 변수들의 영향을 통제했을 때의 순수한 효과를 찾는 과정입니다. 
> 
> > [!IMPORTANT] 💡 다변량 분석 세팅 (SPSS)
> > * **종속변수:** **dx** (뇌혈관 질환 여부) 
> > * **공변량(Covariates):** **혈압수준**, **비만수준(bmi_g)**, **콜레스테롤(chol)**, **흡연여부(smoke)**, **음주여부(drink)**, **연령(old)**을 모두 투입합니다. 
> > * **범주형 변수 지정:** **혈압수준**, **bmi_g**, **smoke**, **drink**는 범주형이므로 반드시 '범주형' 버튼에서 지정해 주어야 합니다. 
> 
> > [!WARNING] ⚠️ 분석 옵션 필수 체크
> > 반드시 **[옵션]** 메뉴에서 **'exp(B)에 대한 신뢰구간'**을 체크해야 우리가 해석할 수 있는 **Odds Ratio(OR)**와 그 유의성을 확인할 수 있습니다. 

---

> [!NOTE] 25페이지 – 데이터 가공: BMI 계산 공식
> 
> 분석을 하려는데 자료에 **BMI**나 **비만 그룹** 변수가 없다면 어떻게 할까요? 직접 만들어야 합니다.  SPSS의 **'변수 계산'** 기능을 활용합니다. 
> 
> > [!LIST] 📝 BMI 산출 공식 (Syntax)
> > * **공식:** `COMPUTE bmi = wt / ((ht / 100)**2).` 
> > * **설명:** **체중(kg)**을 **신장(m)의 제곱**으로 나눕니다.  자료의 키가 cm 단위라면 반드시 **100**으로 나누어 미터(m)로 변환해야 함을 잊지 마세요. 

---

> [!NOTE] 26-27페이지 – 연속변수의 범주화 (BMI Grouping)
> 
> 계산된 연속형 BMI를 그대로 쓸 수도 있지만, 임상적 해석을 위해 **범주형(bmi_g)**으로 변환하는 경우가 많습니다. 
> 
> > [!IMPORTANT] 🔑 BMI 그룹화 기준
> > 1. **저체중 (1):** BMI < **18.5** 
> > 2. **정상 (2):** **18.5** ≤ BMI < **23** 
> > 3. **과체중 (3):** **23** ≤ BMI < **25** 
> > 4. **비만 (4):** BMI ≥ **25** 
> 
> > [!TIP] ⭐️ 실무 포인트
> > SPSS **'변수 계산'** 창에서 **[조건]** 버튼을 눌러 각 범위에 해당하는 케이스만 선택하여 값을 부여하면 됩니다.  이 과정이 정확해야 최종 로지스틱 분석 결과도 신뢰할 수 있습니다. 

], ['\\(', '\\)'\|',
    displayMath: [['$$', '$$'], ['\\[', '\\]']],
    processEscapes: true,
  },
  svg: {
    fontCache: 'global'
  }
};
</script>
<script type="text/javascript" id="MathJax-script" async
  src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-svg.js">
</script>

>[!quote] 공지
>본 자료의 저작권은 **KAISTUDY**에 있습니다.

## 📌 Group 1: 역학 연구 설계와 연관성 지표 (P. 1-5)

> [!NOTE] 1페이지 – 강의 서두
> 
> 자, 여러분 반갑습니다. 오늘부터 우리는 의학 통계의 꽃이라고 할 수 있는 **로지스틱 회귀분석(Logistic Regression)**에 대해 심도 있게 다뤄볼 겁니다. 본격적인 통계 모델링에 들어가기에 앞서, 우리가 왜 이 분석을 배워야 하는지 역학 연구의 기본 설계부터 복습해 봅시다.
> 
> > [!INFO] 🧬 학습 개요
> > * **과목명:** 의과학 생체통계학 (Biostatistics in Medical Science) 
> > * **주제:** 로지스틱 회귀분석 (Logistic Regression Analysis) 
> > * **핵심 목표:** 질병 발생에 영향을 미치는 **위험 요인**을 분석하고 **발생 확률**을 예측하는 법을 익히는 것.

---

> [!NOTE] 2페이지 – 코호트 연구(Cohort Study)의 설계
> 
> 먼저 **코호트 연구**부터 보겠습니다. 이 그림은 여러분이 역학 시간에 질리도록 봤을 설계도죠. 
> 
> > [!IMPORTANT] 💡 코호트 연구의 핵심 메커니즘
> > 1. **시작점:** 현재 질병이 없는 집단을 **노출군**과 **비노출군**으로 나눕니다.
> > 2. **방향성:** **시간**의 흐름에 따라 미래로 나아가는 **전향적(Prospective)** 구조입니다.
> > 3. **결과:** 일정 기간 추적 조사 후, 각 군에서 실제 **질병 발생(+)** 여부를 확인합니다.
> 
> 자, 이렇게 '발생'을 직접 관찰하기 때문에 우리는 무엇을 구할 수 있을까요? 바로 다음 장에서 배울 '발생률'입니다.

---

> [!NOTE] 3페이지 – 상대위험도(Relative Risk, RR)의 계산
> 
> 코호트 연구의 결론은 결국 **상대위험도(RR)**로 귀결됩니다. 표 5-6-2를 잘 보세요.
> 
> > [!LIST] 📝 상대위험도 산출 공식
> > * **노출군 발생률:** $\frac{a}{a+b}$ 
> > * **비노출군 발생률:** $\frac{c}{c+d}$ 
> > * **상대위험도(RR):** $\frac{\text{노출군의 발생률}}{\text{비노출군의 발생률}} = \frac{a/(a+b)}{c/(c+d)}$ 
> 
> > [!TIP] ⭐️ 족보 포인트
> > 코호트 연구는 특정 요인에 노출된 사람과 그렇지 않은 사람의 **질병 발생 확률**을 직접 비교할 수 있는 아주 강력한 설계입니다. 하지만 시간과 비용이 많이 들죠. 그래서 우리는 다음 페이지의 설계를 고민하게 됩니다.

---

> [!NOTE] 4페이지 – 환자대조군 연구(Case-control Study)의 설계
> 
> 이번에는 **환자대조군 연구**입니다. 코호트와는 완전히 반대 방향이죠.
> 
> > [!IMPORTANT] 💡 환자대조군 연구의 핵심 메커니즘
> > 1. **시작점:** 이미 병에 걸린 **환자군(Case)**과 걸리지 않은 **대조군(Control)**을 먼저 섭외합니다.
> > 2. **방향성:** 이들이 과거에 위험 요인에 **노출(E+)**되었는지, **비노출(E-)**되었는지를 거꾸로 조사하는 **후향적(Retrospective)** 구조입니다.
> 
> 이 설계는 질병 발생률을 직접 구할 수 없습니다. 이미 환자를 뽑아놓고 시작하니까요. 그래서 RR 대신 사용하는 지표가 바로 '교차비'입니다.

---

> [!NOTE] 5페이지 – 교차비(Odds Ratio, OR)의 개념
> 
> 자, 오늘의 주인공인 로지스틱 회귀분석과 직결되는 개념, **교차비(OR)**입니다. 
> 
> > [!INFO] 🧬 Odds와 Odds Ratio의 정의
> > * **Odds (승산):** 어떤 사건이 **일어날 확률(p)**을 **일어나지 않을 확률(1-p)**로 나눈 값 ($\text{Odds} = \frac{p}{1-p}$) 
> > * **Odds Ratio (교차비):** 환자군의 Odds를 대조군의 Odds로 나눈 비율 
> 
> > [!IMPORTANT] 💡 교차비 산출 공식 (AD/BC)
> > * **환자군 Odds:** $A/C$ 
> > * **대조군 Odds:** $B/D$ 
> > * **최종 OR:** $\frac{A/C}{B/D} = \frac{AD}{BC}$ 
> 
> > [!TIP] ⭐️ 족보 포인트
> > 로지스틱 회귀분석의 결과값은 보통 이 **OR** 형태로 해석하게 됩니다. 특히 질병의 유병률이 낮을 때는 **OR이 RR의 근사치**로 사용될 수 있다는 점을 꼭 기억하세요.

---

## 📌 Group 2: 로지스틱 회귀의 원리와 수학적 모델링 (P. 6-13)

> [!NOTE] 6페이지 – 로지스틱 회귀분석의 정의
> 
> 자, 이제 본격적으로 **로지스틱 회귀분석(Logistic Regression)**의 본체로 들어갑니다. 일반적인 선형 회귀와 가장 큰 차이점이 뭘까요? 바로 **종속변수**의 모양입니다.
> 
> > [!INFO] 🧬 변수의 정의
> > * **종속변인(Y):** 반드시 **이분변수(Binary, 0 or 1)**여야 합니다. (예: 질환 있음=1, 없음=0) 
> > * **독립변인(X):** 연속형, 범주형 등 **척도에 상관없이** 모두 사용할 수 있습니다.
> 
> > [!IMPORTANT] 💡 분석의 목적
> > 단순히 관계를 보는 게 아니라, 특정 사건이 발생할 **확률(Probability)**을 예측하고 **로지스틱 곡선**에 적합시키는 것이 핵심입니다.
> 
> 자, 예를 들어 연령군에 따라 관상동맥성 심질환(CHD)이 생길 확률이 어떻게 변하는지 살펴볼까요? 

---

> [!NOTE] 7-8페이지 – 데이터의 흐름과 시각화
> 
> 앞서 말한 예시를 실제 수치로 봅시다. 7페이지 표와 8페이지 그래프를 연결해서 이해해야 합니다.
> 
> > [!LIST] 📝 연령군별 CHD 발생 특징
> > * **20대:** 발생 비율이 **0.10**에 불과합니다.
> > * **60대:** 발생 비율이 **0.80**까지 치솟습니다.
> > * **경향성:** 연령(X)이 증가함에 따라 질환 확률(Y)이 **비선형적**으로 증가하는 것을 볼 수 있습니다.
> 
> 이 데이터를 좌표평면에 찍어보면, 8페이지처럼 완만한 **S자 형태(S-shape)**의 흐름이 나타납니다. 직선이 아니라 곡선이라는 점에 주목하세요.

---

> [!NOTE] 9-10페이지 – 로지스틱 곡선의 함수 (Sigmoid)
> 
> 왜 직선이 아니라 곡선일까요? 확률은 **0과 1 사이**에만 존재해야 하기 때문입니다. 이를 수학적으로 구현한 것이 바로 **로지스틱 함수**입니다.
> 
> > [!IMPORTANT] 💡 로지스틱 함수 공식
> > $$f(z) = \frac{1}{1 + e^{-z}} = \frac{e^{z}}{1 + e^{z}}$$ 
> 
> > [!WARNING] ⚠️ 함수의 특성
> > * $z$값이 **$-\infty$**로 가면 확률은 **0**에 수렴합니다.
> > * $z$값이 **$+\infty$**로 가면 확률은 **1**에 수렴합니다.
> > * $z=0$일 때, 정확히 **0.5(50%)**의 확률을 갖습니다.
> 
> 이 아름다운 곡선은 1838년 **Verhulst**가 인구 성장 모델을 보정하기 위해 제안한 모델에서 유래되었습니다.

---

> [!NOTE] 12페이지 – 의학 연구에서의 적용
> 
> 자, 이제 이 수학을 의학에 적용해 봅시다. 우리가 궁금한 건 '이 환자가 병에 걸릴 확률'이죠.
> 
> > [!INFO] 🧬 모델의 구성 요소
> > * **$f(z)$:** 특정 조건(z)을 가진 개인이 **질병을 얻을 확률(P)**입니다.
> > * **$Z$:** 우리가 가진 여러 **독립변수들의 선형 조합**입니다.
> 
> > [!LIST] 📝 선형 예측식 (Linear Predictor)
> > $$z = \alpha + \beta_{1}X_{1} + \beta_{2}X_{2} + \dots + \beta_{k}X_{k} + \epsilon$$ 
> 
> 예를 들어, $z$에 **연령, 성별, 흡연 여부**를 다 집어넣어서 계산된 값이 최종적으로 질병 확률 $P$로 변환되는 과정인 겁니다.

---

> [!NOTE] 13페이지 – 로짓(Logit) 변환과 교차비(OR)
> 
> 이 페이지가 오늘 강의의 **하이라이트**이자 시험에 반드시 나오는 부분입니다. 별표 치세요.
> 
> > [!IMPORTANT] 🔑 Logit 변환: 확률을 직선으로!
> > 확률 $P$를 그대로 쓰면 곡선이라 다루기 어렵죠? 그래서 **Odds에 자연로그(Ln)**를 취합니다.
> > $$Ln(\text{Odds}) = Ln\left(\frac{P}{1-P}\right) = z = \alpha + \beta_{1}X_{1} + \dots$$ 
> > 이를 **로짓 변환(Logit Transformation)**이라고 부릅니다.
> 
> > [!TIP] ⭐️ 족보 포인트: 회귀계수($\beta$)의 해석
> > * 로지스틱 회귀에서 구한 계수 **$\beta_{1}$**은 **$Ln(\text{Odds Ratio})$**와 같습니다.
> > * 따라서 우리가 진짜 궁금한 **교차비(OR)**를 구하려면 계수에 **지수함수($Exp$)**를 취해야 합니다.
> > * **$\text{OR} = e^{\beta}$** 
> 
> "독립변수 $X$가 1단위 증가할 때, 질병의 Odds가 $e^{\beta}$배 증가한다"라고 해석하는 거죠. 이해되시죠?

---

## 📌 Group 3: 실전 분석 및 SPSS 실습 (P. 14-22)

> [!NOTE] 14페이지 – 로지스틱 회귀분석의 실제 사례 (비알콜성 지방간)
> 
> 자, 이론을 배웠으니 실제 논문 데이터를 봅시다. **비알콜성 지방간질환(NAFLD)**과 연관된 인자들을 분석한 표입니다.
> 
> > [!quote] 🩺 임상 데이터 해석: Independent factors
> > * **BMI ($kg/m^{2}$):** **OR 1.378**로, BMI가 1 증가할 때마다 지방간 위험이 약 **38%**씩 높아집니다.
> > * **당뇨(DM):** **OR 2.950**입니다. 당뇨가 있으면 없는 사람보다 위험도가 약 **3배**나 높다는 뜻이죠.
> > * **고중성지방혈증:** **OR 1.815**로 나타나네요.
> 
> 이처럼 **p-value**가 0.05보다 작으면서 **95% CI(신뢰구간)**가 1을 포함하지 않는 변수들이 '독립적인 위험 인자'가 됩니다.

---

> [!NOTE] 15-16페이지 – SPSS 실습 데이터 설정 (sample.sav)
> 
> 이제 직접 돌려볼 시간입니다. **sample.sav** 파일을 열어보세요. 허혈성 뇌혈관질환자(환자군)와 대조군을 비교하는 자료입니다.
> 
> > [!IMPORTANT] 💡 주요 변수 마스터 코딩
> > * **dx (종속변수):** **뇌혈관 질환 여부**입니다. 대조군은 **0**, 질환자는 **1**로 코딩되어 있죠.
> > * **sbp/dbp:** 수축기/이완기 혈압입니다.
> > * **smoke/drink:** 흡연 및 음주 여부입니다.
> 
> 이 데이터를 가지고 우리가 먼저 할 일은 연속형인 혈압 데이터를 의미 있는 그룹으로 나누는 것입니다.

---

> [!NOTE] 17-19페이지 – 변수 계산 및 리코딩 (혈압 분류)
> 
> 의학적으로 혈압은 단순히 수치보다 **단계별 분류**가 중요합니다. **JNC-7 기준**에 따라 '혈압수준' 변수를 새로 만듭니다.
> 
> > [!LIST] 📝 혈압 수준별 코딩 (SPSS Syntax)
> > 1. **Normal (1):** sbp < 120 **AND** dbp < 80 
> > 2. **Prehypertension (2):** sbp 120-139 **OR** dbp 80-89 
> > 3. **Stage 1 HTN (3):** sbp 140-159 **OR** dbp 90-99 
> > 4. **Stage 2 HTN (4):** sbp ≥ 160 **OR** dbp ≥ 100 
> 
> > [!WARNING] ⚠️ 주의사항
> > SPSS에서 **'변수 계산'** 메뉴를 사용할 때, **'케이스 조건'**에서 AND(&)와 OR(|) 조건을 정확히 입력해야 에러가 나지 않습니다.

---

> [!NOTE] 20-21페이지 – 이분형 로지스틱 회귀분석 실행
> 
> 이제 메뉴에서 **[분석] -> [회귀분석] -> [이분형 로지스틱]**을 클릭하세요.
> 
> > [!IMPORTANT] 🔑 분석 세팅 값
> > * **종속변수:** **dx** (뇌혈관 질환 여부) 
> > * **공변량:** **혈압수준** (우리가 방금 만든 변수) 
> > * **범주형 버튼:** '혈압수준'을 넣고 **참조범주**를 '처음'(Normal)으로 설정하세요.
> > * **옵션 버튼:** 반드시 **'exp(B)에 대한 신뢰구간(95%)'**을 체크해야 OR 값을 얻을 수 있습니다.

---

> [!NOTE] 22페이지 – 결과 해석 (Variables in the Equation)
> 
> 가장 중요한 결과 표인 **'Variables in the Equation'**을 봅시다. 분석이 아주 잘 되었네요.
> 
> > [!TIP] ⭐️ 족보 포인트: 혈압과 뇌졸중의 관계
> > * **Normal(ref.):** 비교의 기준입니다.
> > * **Stage 2 HTN:** **Exp(B)**, 즉 **OR** 값이 무려 **63.786**입니다! 
> > * **해석:** 정상 혈압인 사람에 비해 2단계 고혈압 환자는 뇌졸중 발생 위험(Odds)이 **약 63.8배**나 높다는 충격적인 결과입니다.
> 
> > [!INFO] 🧬 모델 적합도 확인
> > **Omnibus Tests**의 p-value가 **.000**이므로 이 회귀 모델은 매우 유의미하며, 전체 예측 정확도는 **81.2%**입니다.
>
>  자, 단변량 분석 결과가 이렇게 명확하게 나왔습니다. 하지만 실제 환자는 혈압만 높은 게 아니죠? 비만도도 있고 나이도 많을 겁니다. 이 모든 걸 한꺼번에 넣고 돌리는 '다변량 모형'을 다음 장에서 만들어봅시다.

---
## 📌 Group 4: 다변량 모형 구축 및 데이터 가공 (P. 23-27)

> [!NOTE] 23-24페이지 – 다변량 로지스틱 회귀모형 설정
> 
> 자, 이제 여러 위험 요인을 동시에 고려하는 **다변량 모형(Multivariate Model)**을 만들어 봅시다.  단순히 혈압만 보는 게 아니라, 다른 변수들의 영향을 통제했을 때의 순수한 효과를 찾는 과정입니다. 
> 
> > [!IMPORTANT] 💡 다변량 분석 세팅 (SPSS)
> > * **종속변수:** **dx** (뇌혈관 질환 여부) 
> > * **공변량(Covariates):** **혈압수준**, **비만수준(bmi_g)**, **콜레스테롤(chol)**, **흡연여부(smoke)**, **음주여부(drink)**, **연령(old)**을 모두 투입합니다. 
> > * **범주형 변수 지정:** **혈압수준**, **bmi_g**, **smoke**, **drink**는 범주형이므로 반드시 '범주형' 버튼에서 지정해 주어야 합니다. 
> 
> > [!WARNING] ⚠️ 분석 옵션 필수 체크
> > 반드시 **[옵션]** 메뉴에서 **'exp(B)에 대한 신뢰구간'**을 체크해야 우리가 해석할 수 있는 **Odds Ratio(OR)**와 그 유의성을 확인할 수 있습니다. 

---

> [!NOTE] 25페이지 – 데이터 가공: BMI 계산 공식
> 
> 분석을 하려는데 자료에 **BMI**나 **비만 그룹** 변수가 없다면 어떻게 할까요? 직접 만들어야 합니다.  SPSS의 **'변수 계산'** 기능을 활용합니다. 
> 
> > [!LIST] 📝 BMI 산출 공식 (Syntax)
> > * **공식:** `COMPUTE bmi = wt / ((ht / 100)**2).` 
> > * **설명:** **체중(kg)**을 **신장(m)의 제곱**으로 나눕니다.  자료의 키가 cm 단위라면 반드시 **100**으로 나누어 미터(m)로 변환해야 함을 잊지 마세요. 

---

> [!NOTE] 26-27페이지 – 연속변수의 범주화 (BMI Grouping)
> 
> 계산된 연속형 BMI를 그대로 쓸 수도 있지만, 임상적 해석을 위해 **범주형(bmi_g)**으로 변환하는 경우가 많습니다. 
> 
> > [!IMPORTANT] 🔑 BMI 그룹화 기준
> > 1. **저체중 (1):** BMI < **18.5** 
> > 2. **정상 (2):** **18.5** ≤ BMI < **23** 
> > 3. **과체중 (3):** **23** ≤ BMI < **25** 
> > 4. **비만 (4):** BMI ≥ **25** 
> 
> > [!TIP] ⭐️ 실무 포인트
> > SPSS **'변수 계산'** 창에서 **[조건]** 버튼을 눌러 각 범위에 해당하는 케이스만 선택하여 값을 부여하면 됩니다.  이 과정이 정확해야 최종 로지스틱 분석 결과도 신뢰할 수 있습니다. 

, ',
    displayMath: [['$$', '$$'], ['\\[', '\\]']],
    processEscapes: true,
  },
  svg: {
    fontCache: 'global'
  }
};
</script>
<script type="text/javascript" id="MathJax-script" async
  src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-svg.js">
</script>

>[!quote] 공지
>본 자료의 저작권은 **KAISTUDY**에 있습니다.

## 📌 Group 1: 역학 연구 설계와 연관성 지표 (P. 1-5)

> [!NOTE] 1페이지 – 강의 서두
> 
> 자, 여러분 반갑습니다. 오늘부터 우리는 의학 통계의 꽃이라고 할 수 있는 **로지스틱 회귀분석(Logistic Regression)**에 대해 심도 있게 다뤄볼 겁니다. 본격적인 통계 모델링에 들어가기에 앞서, 우리가 왜 이 분석을 배워야 하는지 역학 연구의 기본 설계부터 복습해 봅시다.
> 
> > [!INFO] 🧬 학습 개요
> > * **과목명:** 의과학 생체통계학 (Biostatistics in Medical Science) 
> > * **주제:** 로지스틱 회귀분석 (Logistic Regression Analysis) 
> > * **핵심 목표:** 질병 발생에 영향을 미치는 **위험 요인**을 분석하고 **발생 확률**을 예측하는 법을 익히는 것.

---

> [!NOTE] 2페이지 – 코호트 연구(Cohort Study)의 설계
> 
> 먼저 **코호트 연구**부터 보겠습니다. 이 그림은 여러분이 역학 시간에 질리도록 봤을 설계도죠. 
> 
> > [!IMPORTANT] 💡 코호트 연구의 핵심 메커니즘
> > 1. **시작점:** 현재 질병이 없는 집단을 **노출군**과 **비노출군**으로 나눕니다.
> > 2. **방향성:** **시간**의 흐름에 따라 미래로 나아가는 **전향적(Prospective)** 구조입니다.
> > 3. **결과:** 일정 기간 추적 조사 후, 각 군에서 실제 **질병 발생(+)** 여부를 확인합니다.
> 
> 자, 이렇게 '발생'을 직접 관찰하기 때문에 우리는 무엇을 구할 수 있을까요? 바로 다음 장에서 배울 '발생률'입니다.

---

> [!NOTE] 3페이지 – 상대위험도(Relative Risk, RR)의 계산
> 
> 코호트 연구의 결론은 결국 **상대위험도(RR)**로 귀결됩니다. 표 5-6-2를 잘 보세요.
> 
> > [!LIST] 📝 상대위험도 산출 공식
> > * **노출군 발생률:** $\frac{a}{a+b}$ 
> > * **비노출군 발생률:** $\frac{c}{c+d}$ 
> > * **상대위험도(RR):** $\frac{\text{노출군의 발생률}}{\text{비노출군의 발생률}} = \frac{a/(a+b)}{c/(c+d)}$ 
> 
> > [!TIP] ⭐️ 족보 포인트
> > 코호트 연구는 특정 요인에 노출된 사람과 그렇지 않은 사람의 **질병 발생 확률**을 직접 비교할 수 있는 아주 강력한 설계입니다. 하지만 시간과 비용이 많이 들죠. 그래서 우리는 다음 페이지의 설계를 고민하게 됩니다.

---

> [!NOTE] 4페이지 – 환자대조군 연구(Case-control Study)의 설계
> 
> 이번에는 **환자대조군 연구**입니다. 코호트와는 완전히 반대 방향이죠.
> 
> > [!IMPORTANT] 💡 환자대조군 연구의 핵심 메커니즘
> > 1. **시작점:** 이미 병에 걸린 **환자군(Case)**과 걸리지 않은 **대조군(Control)**을 먼저 섭외합니다.
> > 2. **방향성:** 이들이 과거에 위험 요인에 **노출(E+)**되었는지, **비노출(E-)**되었는지를 거꾸로 조사하는 **후향적(Retrospective)** 구조입니다.
> 
> 이 설계는 질병 발생률을 직접 구할 수 없습니다. 이미 환자를 뽑아놓고 시작하니까요. 그래서 RR 대신 사용하는 지표가 바로 '교차비'입니다.

---

> [!NOTE] 5페이지 – 교차비(Odds Ratio, OR)의 개념
> 
> 자, 오늘의 주인공인 로지스틱 회귀분석과 직결되는 개념, **교차비(OR)**입니다. 
> 
> > [!INFO] 🧬 Odds와 Odds Ratio의 정의
> > * **Odds (승산):** 어떤 사건이 **일어날 확률(p)**을 **일어나지 않을 확률(1-p)**로 나눈 값 ($\text{Odds} = \frac{p}{1-p}$) 
> > * **Odds Ratio (교차비):** 환자군의 Odds를 대조군의 Odds로 나눈 비율 
> 
> > [!IMPORTANT] 💡 교차비 산출 공식 (AD/BC)
> > * **환자군 Odds:** $A/C$ 
> > * **대조군 Odds:** $B/D$ 
> > * **최종 OR:** $\frac{A/C}{B/D} = \frac{AD}{BC}$ 
> 
> > [!TIP] ⭐️ 족보 포인트
> > 로지스틱 회귀분석의 결과값은 보통 이 **OR** 형태로 해석하게 됩니다. 특히 질병의 유병률이 낮을 때는 **OR이 RR의 근사치**로 사용될 수 있다는 점을 꼭 기억하세요.

---

## 📌 Group 2: 로지스틱 회귀의 원리와 수학적 모델링 (P. 6-13)

> [!NOTE] 6페이지 – 로지스틱 회귀분석의 정의
> 
> 자, 이제 본격적으로 **로지스틱 회귀분석(Logistic Regression)**의 본체로 들어갑니다. 일반적인 선형 회귀와 가장 큰 차이점이 뭘까요? 바로 **종속변수**의 모양입니다.
> 
> > [!INFO] 🧬 변수의 정의
> > * **종속변인(Y):** 반드시 **이분변수(Binary, 0 or 1)**여야 합니다. (예: 질환 있음=1, 없음=0) 
> > * **독립변인(X):** 연속형, 범주형 등 **척도에 상관없이** 모두 사용할 수 있습니다.
> 
> > [!IMPORTANT] 💡 분석의 목적
> > 단순히 관계를 보는 게 아니라, 특정 사건이 발생할 **확률(Probability)**을 예측하고 **로지스틱 곡선**에 적합시키는 것이 핵심입니다.
> 
> 자, 예를 들어 연령군에 따라 관상동맥성 심질환(CHD)이 생길 확률이 어떻게 변하는지 살펴볼까요? 

---

> [!NOTE] 7-8페이지 – 데이터의 흐름과 시각화
> 
> 앞서 말한 예시를 실제 수치로 봅시다. 7페이지 표와 8페이지 그래프를 연결해서 이해해야 합니다.
> 
> > [!LIST] 📝 연령군별 CHD 발생 특징
> > * **20대:** 발생 비율이 **0.10**에 불과합니다.
> > * **60대:** 발생 비율이 **0.80**까지 치솟습니다.
> > * **경향성:** 연령(X)이 증가함에 따라 질환 확률(Y)이 **비선형적**으로 증가하는 것을 볼 수 있습니다.
> 
> 이 데이터를 좌표평면에 찍어보면, 8페이지처럼 완만한 **S자 형태(S-shape)**의 흐름이 나타납니다. 직선이 아니라 곡선이라는 점에 주목하세요.

---

> [!NOTE] 9-10페이지 – 로지스틱 곡선의 함수 (Sigmoid)
> 
> 왜 직선이 아니라 곡선일까요? 확률은 **0과 1 사이**에만 존재해야 하기 때문입니다. 이를 수학적으로 구현한 것이 바로 **로지스틱 함수**입니다.
> 
> > [!IMPORTANT] 💡 로지스틱 함수 공식
> > $$f(z) = \frac{1}{1 + e^{-z}} = \frac{e^{z}}{1 + e^{z}}$$ 
> 
> > [!WARNING] ⚠️ 함수의 특성
> > * $z$값이 **$-\infty$**로 가면 확률은 **0**에 수렴합니다.
> > * $z$값이 **$+\infty$**로 가면 확률은 **1**에 수렴합니다.
> > * $z=0$일 때, 정확히 **0.5(50%)**의 확률을 갖습니다.
> 
> 이 아름다운 곡선은 1838년 **Verhulst**가 인구 성장 모델을 보정하기 위해 제안한 모델에서 유래되었습니다.

---

> [!NOTE] 12페이지 – 의학 연구에서의 적용
> 
> 자, 이제 이 수학을 의학에 적용해 봅시다. 우리가 궁금한 건 '이 환자가 병에 걸릴 확률'이죠.
> 
> > [!INFO] 🧬 모델의 구성 요소
> > * **$f(z)$:** 특정 조건(z)을 가진 개인이 **질병을 얻을 확률(P)**입니다.
> > * **$Z$:** 우리가 가진 여러 **독립변수들의 선형 조합**입니다.
> 
> > [!LIST] 📝 선형 예측식 (Linear Predictor)
> > $$z = \alpha + \beta_{1}X_{1} + \beta_{2}X_{2} + \dots + \beta_{k}X_{k} + \epsilon$$ 
> 
> 예를 들어, $z$에 **연령, 성별, 흡연 여부**를 다 집어넣어서 계산된 값이 최종적으로 질병 확률 $P$로 변환되는 과정인 겁니다.

---

> [!NOTE] 13페이지 – 로짓(Logit) 변환과 교차비(OR)
> 
> 이 페이지가 오늘 강의의 **하이라이트**이자 시험에 반드시 나오는 부분입니다. 별표 치세요.
> 
> > [!IMPORTANT] 🔑 Logit 변환: 확률을 직선으로!
> > 확률 $P$를 그대로 쓰면 곡선이라 다루기 어렵죠? 그래서 **Odds에 자연로그(Ln)**를 취합니다.
> > $$Ln(\text{Odds}) = Ln\left(\frac{P}{1-P}\right) = z = \alpha + \beta_{1}X_{1} + \dots$$ 
> > 이를 **로짓 변환(Logit Transformation)**이라고 부릅니다.
> 
> > [!TIP] ⭐️ 족보 포인트: 회귀계수($\beta$)의 해석
> > * 로지스틱 회귀에서 구한 계수 **$\beta_{1}$**은 **$Ln(\text{Odds Ratio})$**와 같습니다.
> > * 따라서 우리가 진짜 궁금한 **교차비(OR)**를 구하려면 계수에 **지수함수($Exp$)**를 취해야 합니다.
> > * **$\text{OR} = e^{\beta}$** 
> 
> "독립변수 $X$가 1단위 증가할 때, 질병의 Odds가 $e^{\beta}$배 증가한다"라고 해석하는 거죠. 이해되시죠?

---

## 📌 Group 3: 실전 분석 및 SPSS 실습 (P. 14-22)

> [!NOTE] 14페이지 – 로지스틱 회귀분석의 실제 사례 (비알콜성 지방간)
> 
> 자, 이론을 배웠으니 실제 논문 데이터를 봅시다. **비알콜성 지방간질환(NAFLD)**과 연관된 인자들을 분석한 표입니다.
> 
> > [!quote] 🩺 임상 데이터 해석: Independent factors
> > * **BMI ($kg/m^{2}$):** **OR 1.378**로, BMI가 1 증가할 때마다 지방간 위험이 약 **38%**씩 높아집니다.
> > * **당뇨(DM):** **OR 2.950**입니다. 당뇨가 있으면 없는 사람보다 위험도가 약 **3배**나 높다는 뜻이죠.
> > * **고중성지방혈증:** **OR 1.815**로 나타나네요.
> 
> 이처럼 **p-value**가 0.05보다 작으면서 **95% CI(신뢰구간)**가 1을 포함하지 않는 변수들이 '독립적인 위험 인자'가 됩니다.

---

> [!NOTE] 15-16페이지 – SPSS 실습 데이터 설정 (sample.sav)
> 
> 이제 직접 돌려볼 시간입니다. **sample.sav** 파일을 열어보세요. 허혈성 뇌혈관질환자(환자군)와 대조군을 비교하는 자료입니다.
> 
> > [!IMPORTANT] 💡 주요 변수 마스터 코딩
> > * **dx (종속변수):** **뇌혈관 질환 여부**입니다. 대조군은 **0**, 질환자는 **1**로 코딩되어 있죠.
> > * **sbp/dbp:** 수축기/이완기 혈압입니다.
> > * **smoke/drink:** 흡연 및 음주 여부입니다.
> 
> 이 데이터를 가지고 우리가 먼저 할 일은 연속형인 혈압 데이터를 의미 있는 그룹으로 나누는 것입니다.

---

> [!NOTE] 17-19페이지 – 변수 계산 및 리코딩 (혈압 분류)
> 
> 의학적으로 혈압은 단순히 수치보다 **단계별 분류**가 중요합니다. **JNC-7 기준**에 따라 '혈압수준' 변수를 새로 만듭니다.
> 
> > [!LIST] 📝 혈압 수준별 코딩 (SPSS Syntax)
> > 1. **Normal (1):** sbp < 120 **AND** dbp < 80 
> > 2. **Prehypertension (2):** sbp 120-139 **OR** dbp 80-89 
> > 3. **Stage 1 HTN (3):** sbp 140-159 **OR** dbp 90-99 
> > 4. **Stage 2 HTN (4):** sbp ≥ 160 **OR** dbp ≥ 100 
> 
> > [!WARNING] ⚠️ 주의사항
> > SPSS에서 **'변수 계산'** 메뉴를 사용할 때, **'케이스 조건'**에서 AND(&)와 OR(|) 조건을 정확히 입력해야 에러가 나지 않습니다.

---

> [!NOTE] 20-21페이지 – 이분형 로지스틱 회귀분석 실행
> 
> 이제 메뉴에서 **[분석] -> [회귀분석] -> [이분형 로지스틱]**을 클릭하세요.
> 
> > [!IMPORTANT] 🔑 분석 세팅 값
> > * **종속변수:** **dx** (뇌혈관 질환 여부) 
> > * **공변량:** **혈압수준** (우리가 방금 만든 변수) 
> > * **범주형 버튼:** '혈압수준'을 넣고 **참조범주**를 '처음'(Normal)으로 설정하세요.
> > * **옵션 버튼:** 반드시 **'exp(B)에 대한 신뢰구간(95%)'**을 체크해야 OR 값을 얻을 수 있습니다.

---

> [!NOTE] 22페이지 – 결과 해석 (Variables in the Equation)
> 
> 가장 중요한 결과 표인 **'Variables in the Equation'**을 봅시다. 분석이 아주 잘 되었네요.
> 
> > [!TIP] ⭐️ 족보 포인트: 혈압과 뇌졸중의 관계
> > * **Normal(ref.):** 비교의 기준입니다.
> > * **Stage 2 HTN:** **Exp(B)**, 즉 **OR** 값이 무려 **63.786**입니다! 
> > * **해석:** 정상 혈압인 사람에 비해 2단계 고혈압 환자는 뇌졸중 발생 위험(Odds)이 **약 63.8배**나 높다는 충격적인 결과입니다.
> 
> > [!INFO] 🧬 모델 적합도 확인
> > **Omnibus Tests**의 p-value가 **.000**이므로 이 회귀 모델은 매우 유의미하며, 전체 예측 정확도는 **81.2%**입니다.
>
>  자, 단변량 분석 결과가 이렇게 명확하게 나왔습니다. 하지만 실제 환자는 혈압만 높은 게 아니죠? 비만도도 있고 나이도 많을 겁니다. 이 모든 걸 한꺼번에 넣고 돌리는 '다변량 모형'을 다음 장에서 만들어봅시다.

---
## 📌 Group 4: 다변량 모형 구축 및 데이터 가공 (P. 23-27)

> [!NOTE] 23-24페이지 – 다변량 로지스틱 회귀모형 설정
> 
> 자, 이제 여러 위험 요인을 동시에 고려하는 **다변량 모형(Multivariate Model)**을 만들어 봅시다.  단순히 혈압만 보는 게 아니라, 다른 변수들의 영향을 통제했을 때의 순수한 효과를 찾는 과정입니다. 
> 
> > [!IMPORTANT] 💡 다변량 분석 세팅 (SPSS)
> > * **종속변수:** **dx** (뇌혈관 질환 여부) 
> > * **공변량(Covariates):** **혈압수준**, **비만수준(bmi_g)**, **콜레스테롤(chol)**, **흡연여부(smoke)**, **음주여부(drink)**, **연령(old)**을 모두 투입합니다. 
> > * **범주형 변수 지정:** **혈압수준**, **bmi_g**, **smoke**, **drink**는 범주형이므로 반드시 '범주형' 버튼에서 지정해 주어야 합니다. 
> 
> > [!WARNING] ⚠️ 분석 옵션 필수 체크
> > 반드시 **[옵션]** 메뉴에서 **'exp(B)에 대한 신뢰구간'**을 체크해야 우리가 해석할 수 있는 **Odds Ratio(OR)**와 그 유의성을 확인할 수 있습니다. 

---

> [!NOTE] 25페이지 – 데이터 가공: BMI 계산 공식
> 
> 분석을 하려는데 자료에 **BMI**나 **비만 그룹** 변수가 없다면 어떻게 할까요? 직접 만들어야 합니다.  SPSS의 **'변수 계산'** 기능을 활용합니다. 
> 
> > [!LIST] 📝 BMI 산출 공식 (Syntax)
> > * **공식:** `COMPUTE bmi = wt / ((ht / 100)**2).` 
> > * **설명:** **체중(kg)**을 **신장(m)의 제곱**으로 나눕니다.  자료의 키가 cm 단위라면 반드시 **100**으로 나누어 미터(m)로 변환해야 함을 잊지 마세요. 

---

> [!NOTE] 26-27페이지 – 연속변수의 범주화 (BMI Grouping)
> 
> 계산된 연속형 BMI를 그대로 쓸 수도 있지만, 임상적 해석을 위해 **범주형(bmi_g)**으로 변환하는 경우가 많습니다. 
> 
> > [!IMPORTANT] 🔑 BMI 그룹화 기준
> > 1. **저체중 (1):** BMI < **18.5** 
> > 2. **정상 (2):** **18.5** ≤ BMI < **23** 
> > 3. **과체중 (3):** **23** ≤ BMI < **25** 
> > 4. **비만 (4):** BMI ≥ **25** 
> 
> > [!TIP] ⭐️ 실무 포인트
> > SPSS **'변수 계산'** 창에서 **[조건]** 버튼을 눌러 각 범위에 해당하는 케이스만 선택하여 값을 부여하면 됩니다.  이 과정이 정확해야 최종 로지스틱 분석 결과도 신뢰할 수 있습니다. 

], ['\\(', '\\)']],
    displayMath: [['$$', '$$'], ['\\[', '\\]']],
    processEscapes: true,
  },
  svg: {
    fontCache: 'global'
  }
};
</script>
<script type="text/javascript" id="MathJax-script" async
  src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-svg.js">
</script>

>[!quote] 공지
>본 자료의 저작권은 **KAISTUDY**에 있습니다.

## 📌 Group 1: 역학 연구 설계와 연관성 지표 (P. 1-5)

> [!NOTE] 1페이지 – 강의 서두
> 
> 자, 여러분 반갑습니다. 오늘부터 우리는 의학 통계의 꽃이라고 할 수 있는 **로지스틱 회귀분석(Logistic Regression)**에 대해 심도 있게 다뤄볼 겁니다. 본격적인 통계 모델링에 들어가기에 앞서, 우리가 왜 이 분석을 배워야 하는지 역학 연구의 기본 설계부터 복습해 봅시다.
> 
> > [!INFO] 🧬 학습 개요
> > * **과목명:** 의과학 생체통계학 (Biostatistics in Medical Science) 
> > * **주제:** 로지스틱 회귀분석 (Logistic Regression Analysis) 
> > * **핵심 목표:** 질병 발생에 영향을 미치는 **위험 요인**을 분석하고 **발생 확률**을 예측하는 법을 익히는 것.

---

> [!NOTE] 2페이지 – 코호트 연구(Cohort Study)의 설계
> 
> 먼저 **코호트 연구**부터 보겠습니다. 이 그림은 여러분이 역학 시간에 질리도록 봤을 설계도죠. 
> 
> > [!IMPORTANT] 💡 코호트 연구의 핵심 메커니즘
> > 1. **시작점:** 현재 질병이 없는 집단을 **노출군**과 **비노출군**으로 나눕니다.
> > 2. **방향성:** **시간**의 흐름에 따라 미래로 나아가는 **전향적(Prospective)** 구조입니다.
> > 3. **결과:** 일정 기간 추적 조사 후, 각 군에서 실제 **질병 발생(+)** 여부를 확인합니다.
> 
> 자, 이렇게 '발생'을 직접 관찰하기 때문에 우리는 무엇을 구할 수 있을까요? 바로 다음 장에서 배울 '발생률'입니다.

---

> [!NOTE] 3페이지 – 상대위험도(Relative Risk, RR)의 계산
> 
> 코호트 연구의 결론은 결국 **상대위험도(RR)**로 귀결됩니다. 표 5-6-2를 잘 보세요.
> 
> > [!LIST] 📝 상대위험도 산출 공식
> > * **노출군 발생률:** $\frac{a}{a+b}$ 
> > * **비노출군 발생률:** $\frac{c}{c+d}$ 
> > * **상대위험도(RR):** $\frac{\text{노출군의 발생률}}{\text{비노출군의 발생률}} = \frac{a/(a+b)}{c/(c+d)}$ 
> 
> > [!TIP] ⭐️ 족보 포인트
> > 코호트 연구는 특정 요인에 노출된 사람과 그렇지 않은 사람의 **질병 발생 확률**을 직접 비교할 수 있는 아주 강력한 설계입니다. 하지만 시간과 비용이 많이 들죠. 그래서 우리는 다음 페이지의 설계를 고민하게 됩니다.

---

> [!NOTE] 4페이지 – 환자대조군 연구(Case-control Study)의 설계
> 
> 이번에는 **환자대조군 연구**입니다. 코호트와는 완전히 반대 방향이죠.
> 
> > [!IMPORTANT] 💡 환자대조군 연구의 핵심 메커니즘
> > 1. **시작점:** 이미 병에 걸린 **환자군(Case)**과 걸리지 않은 **대조군(Control)**을 먼저 섭외합니다.
> > 2. **방향성:** 이들이 과거에 위험 요인에 **노출(E+)**되었는지, **비노출(E-)**되었는지를 거꾸로 조사하는 **후향적(Retrospective)** 구조입니다.
> 
> 이 설계는 질병 발생률을 직접 구할 수 없습니다. 이미 환자를 뽑아놓고 시작하니까요. 그래서 RR 대신 사용하는 지표가 바로 '교차비'입니다.

---

> [!NOTE] 5페이지 – 교차비(Odds Ratio, OR)의 개념
> 
> 자, 오늘의 주인공인 로지스틱 회귀분석과 직결되는 개념, **교차비(OR)**입니다. 
> 
> > [!INFO] 🧬 Odds와 Odds Ratio의 정의
> > * **Odds (승산):** 어떤 사건이 **일어날 확률(p)**을 **일어나지 않을 확률(1-p)**로 나눈 값 ($\text{Odds} = \frac{p}{1-p}$) 
> > * **Odds Ratio (교차비):** 환자군의 Odds를 대조군의 Odds로 나눈 비율 
> 
> > [!IMPORTANT] 💡 교차비 산출 공식 (AD/BC)
> > * **환자군 Odds:** $A/C$ 
> > * **대조군 Odds:** $B/D$ 
> > * **최종 OR:** $\frac{A/C}{B/D} = \frac{AD}{BC}$ 
> 
> > [!TIP] ⭐️ 족보 포인트
> > 로지스틱 회귀분석의 결과값은 보통 이 **OR** 형태로 해석하게 됩니다. 특히 질병의 유병률이 낮을 때는 **OR이 RR의 근사치**로 사용될 수 있다는 점을 꼭 기억하세요.

---

## 📌 Group 2: 로지스틱 회귀의 원리와 수학적 모델링 (P. 6-13)

> [!NOTE] 6페이지 – 로지스틱 회귀분석의 정의
> 
> 자, 이제 본격적으로 **로지스틱 회귀분석(Logistic Regression)**의 본체로 들어갑니다. 일반적인 선형 회귀와 가장 큰 차이점이 뭘까요? 바로 **종속변수**의 모양입니다.
> 
> > [!INFO] 🧬 변수의 정의
> > * **종속변인(Y):** 반드시 **이분변수(Binary, 0 or 1)**여야 합니다. (예: 질환 있음=1, 없음=0) 
> > * **독립변인(X):** 연속형, 범주형 등 **척도에 상관없이** 모두 사용할 수 있습니다.
> 
> > [!IMPORTANT] 💡 분석의 목적
> > 단순히 관계를 보는 게 아니라, 특정 사건이 발생할 **확률(Probability)**을 예측하고 **로지스틱 곡선**에 적합시키는 것이 핵심입니다.
> 
> 자, 예를 들어 연령군에 따라 관상동맥성 심질환(CHD)이 생길 확률이 어떻게 변하는지 살펴볼까요? 

---

> [!NOTE] 7-8페이지 – 데이터의 흐름과 시각화
> 
> 앞서 말한 예시를 실제 수치로 봅시다. 7페이지 표와 8페이지 그래프를 연결해서 이해해야 합니다.
> 
> > [!LIST] 📝 연령군별 CHD 발생 특징
> > * **20대:** 발생 비율이 **0.10**에 불과합니다.
> > * **60대:** 발생 비율이 **0.80**까지 치솟습니다.
> > * **경향성:** 연령(X)이 증가함에 따라 질환 확률(Y)이 **비선형적**으로 증가하는 것을 볼 수 있습니다.
> 
> 이 데이터를 좌표평면에 찍어보면, 8페이지처럼 완만한 **S자 형태(S-shape)**의 흐름이 나타납니다. 직선이 아니라 곡선이라는 점에 주목하세요.

---

> [!NOTE] 9-10페이지 – 로지스틱 곡선의 함수 (Sigmoid)
> 
> 왜 직선이 아니라 곡선일까요? 확률은 **0과 1 사이**에만 존재해야 하기 때문입니다. 이를 수학적으로 구현한 것이 바로 **로지스틱 함수**입니다.
> 
> > [!IMPORTANT] 💡 로지스틱 함수 공식
> > $$f(z) = \frac{1}{1 + e^{-z}} = \frac{e^{z}}{1 + e^{z}}$$ 
> 
> > [!WARNING] ⚠️ 함수의 특성
> > * $z$값이 **$-\infty$**로 가면 확률은 **0**에 수렴합니다.
> > * $z$값이 **$+\infty$**로 가면 확률은 **1**에 수렴합니다.
> > * $z=0$일 때, 정확히 **0.5(50%)**의 확률을 갖습니다.
> 
> 이 아름다운 곡선은 1838년 **Verhulst**가 인구 성장 모델을 보정하기 위해 제안한 모델에서 유래되었습니다.

---

> [!NOTE] 12페이지 – 의학 연구에서의 적용
> 
> 자, 이제 이 수학을 의학에 적용해 봅시다. 우리가 궁금한 건 '이 환자가 병에 걸릴 확률'이죠.
> 
> > [!INFO] 🧬 모델의 구성 요소
> > * **$f(z)$:** 특정 조건(z)을 가진 개인이 **질병을 얻을 확률(P)**입니다.
> > * **$Z$:** 우리가 가진 여러 **독립변수들의 선형 조합**입니다.
> 
> > [!LIST] 📝 선형 예측식 (Linear Predictor)
> > $$z = \alpha + \beta_{1}X_{1} + \beta_{2}X_{2} + \dots + \beta_{k}X_{k} + \epsilon$$ 
> 
> 예를 들어, $z$에 **연령, 성별, 흡연 여부**를 다 집어넣어서 계산된 값이 최종적으로 질병 확률 $P$로 변환되는 과정인 겁니다.

---

> [!NOTE] 13페이지 – 로짓(Logit) 변환과 교차비(OR)
> 
> 이 페이지가 오늘 강의의 **하이라이트**이자 시험에 반드시 나오는 부분입니다. 별표 치세요.
> 
> > [!IMPORTANT] 🔑 Logit 변환: 확률을 직선으로!
> > 확률 $P$를 그대로 쓰면 곡선이라 다루기 어렵죠? 그래서 **Odds에 자연로그(Ln)**를 취합니다.
> > $$Ln(\text{Odds}) = Ln\left(\frac{P}{1-P}\right) = z = \alpha + \beta_{1}X_{1} + \dots$$ 
> > 이를 **로짓 변환(Logit Transformation)**이라고 부릅니다.
> 
> > [!TIP] ⭐️ 족보 포인트: 회귀계수($\beta$)의 해석
> > * 로지스틱 회귀에서 구한 계수 **$\beta_{1}$**은 **$Ln(\text{Odds Ratio})$**와 같습니다.
> > * 따라서 우리가 진짜 궁금한 **교차비(OR)**를 구하려면 계수에 **지수함수($Exp$)**를 취해야 합니다.
> > * **$\text{OR} = e^{\beta}$** 
> 
> "독립변수 $X$가 1단위 증가할 때, 질병의 Odds가 $e^{\beta}$배 증가한다"라고 해석하는 거죠. 이해되시죠?

---

## 📌 Group 3: 실전 분석 및 SPSS 실습 (P. 14-22)

> [!NOTE] 14페이지 – 로지스틱 회귀분석의 실제 사례 (비알콜성 지방간)
> 
> 자, 이론을 배웠으니 실제 논문 데이터를 봅시다. **비알콜성 지방간질환(NAFLD)**과 연관된 인자들을 분석한 표입니다.
> 
> > [!quote] 🩺 임상 데이터 해석: Independent factors
> > * **BMI ($kg/m^{2}$):** **OR 1.378**로, BMI가 1 증가할 때마다 지방간 위험이 약 **38%**씩 높아집니다.
> > * **당뇨(DM):** **OR 2.950**입니다. 당뇨가 있으면 없는 사람보다 위험도가 약 **3배**나 높다는 뜻이죠.
> > * **고중성지방혈증:** **OR 1.815**로 나타나네요.
> 
> 이처럼 **p-value**가 0.05보다 작으면서 **95% CI(신뢰구간)**가 1을 포함하지 않는 변수들이 '독립적인 위험 인자'가 됩니다.

---

> [!NOTE] 15-16페이지 – SPSS 실습 데이터 설정 (sample.sav)
> 
> 이제 직접 돌려볼 시간입니다. **sample.sav** 파일을 열어보세요. 허혈성 뇌혈관질환자(환자군)와 대조군을 비교하는 자료입니다.
> 
> > [!IMPORTANT] 💡 주요 변수 마스터 코딩
> > * **dx (종속변수):** **뇌혈관 질환 여부**입니다. 대조군은 **0**, 질환자는 **1**로 코딩되어 있죠.
> > * **sbp/dbp:** 수축기/이완기 혈압입니다.
> > * **smoke/drink:** 흡연 및 음주 여부입니다.
> 
> 이 데이터를 가지고 우리가 먼저 할 일은 연속형인 혈압 데이터를 의미 있는 그룹으로 나누는 것입니다.

---

> [!NOTE] 17-19페이지 – 변수 계산 및 리코딩 (혈압 분류)
> 
> 의학적으로 혈압은 단순히 수치보다 **단계별 분류**가 중요합니다. **JNC-7 기준**에 따라 '혈압수준' 변수를 새로 만듭니다.
> 
> > [!LIST] 📝 혈압 수준별 코딩 (SPSS Syntax)
> > 1. **Normal (1):** sbp < 120 **AND** dbp < 80 
> > 2. **Prehypertension (2):** sbp 120-139 **OR** dbp 80-89 
> > 3. **Stage 1 HTN (3):** sbp 140-159 **OR** dbp 90-99 
> > 4. **Stage 2 HTN (4):** sbp ≥ 160 **OR** dbp ≥ 100 
> 
> > [!WARNING] ⚠️ 주의사항
> > SPSS에서 **'변수 계산'** 메뉴를 사용할 때, **'케이스 조건'**에서 AND(&)와 OR(|) 조건을 정확히 입력해야 에러가 나지 않습니다.

---

> [!NOTE] 20-21페이지 – 이분형 로지스틱 회귀분석 실행
> 
> 이제 메뉴에서 **[분석] -> [회귀분석] -> [이분형 로지스틱]**을 클릭하세요.
> 
> > [!IMPORTANT] 🔑 분석 세팅 값
> > * **종속변수:** **dx** (뇌혈관 질환 여부) 
> > * **공변량:** **혈압수준** (우리가 방금 만든 변수) 
> > * **범주형 버튼:** '혈압수준'을 넣고 **참조범주**를 '처음'(Normal)으로 설정하세요.
> > * **옵션 버튼:** 반드시 **'exp(B)에 대한 신뢰구간(95%)'**을 체크해야 OR 값을 얻을 수 있습니다.

---

> [!NOTE] 22페이지 – 결과 해석 (Variables in the Equation)
> 
> 가장 중요한 결과 표인 **'Variables in the Equation'**을 봅시다. 분석이 아주 잘 되었네요.
> 
> > [!TIP] ⭐️ 족보 포인트: 혈압과 뇌졸중의 관계
> > * **Normal(ref.):** 비교의 기준입니다.
> > * **Stage 2 HTN:** **Exp(B)**, 즉 **OR** 값이 무려 **63.786**입니다! 
> > * **해석:** 정상 혈압인 사람에 비해 2단계 고혈압 환자는 뇌졸중 발생 위험(Odds)이 **약 63.8배**나 높다는 충격적인 결과입니다.
> 
> > [!INFO] 🧬 모델 적합도 확인
> > **Omnibus Tests**의 p-value가 **.000**이므로 이 회귀 모델은 매우 유의미하며, 전체 예측 정확도는 **81.2%**입니다.
>
>  자, 단변량 분석 결과가 이렇게 명확하게 나왔습니다. 하지만 실제 환자는 혈압만 높은 게 아니죠? 비만도도 있고 나이도 많을 겁니다. 이 모든 걸 한꺼번에 넣고 돌리는 '다변량 모형'을 다음 장에서 만들어봅시다.

---
## 📌 Group 4: 다변량 모형 구축 및 데이터 가공 (P. 23-27)

> [!NOTE] 23-24페이지 – 다변량 로지스틱 회귀모형 설정
> 
> 자, 이제 여러 위험 요인을 동시에 고려하는 **다변량 모형(Multivariate Model)**을 만들어 봅시다.  단순히 혈압만 보는 게 아니라, 다른 변수들의 영향을 통제했을 때의 순수한 효과를 찾는 과정입니다. 
> 
> > [!IMPORTANT] 💡 다변량 분석 세팅 (SPSS)
> > * **종속변수:** **dx** (뇌혈관 질환 여부) 
> > * **공변량(Covariates):** **혈압수준**, **비만수준(bmi_g)**, **콜레스테롤(chol)**, **흡연여부(smoke)**, **음주여부(drink)**, **연령(old)**을 모두 투입합니다. 
> > * **범주형 변수 지정:** **혈압수준**, **bmi_g**, **smoke**, **drink**는 범주형이므로 반드시 '범주형' 버튼에서 지정해 주어야 합니다. 
> 
> > [!WARNING] ⚠️ 분석 옵션 필수 체크
> > 반드시 **[옵션]** 메뉴에서 **'exp(B)에 대한 신뢰구간'**을 체크해야 우리가 해석할 수 있는 **Odds Ratio(OR)**와 그 유의성을 확인할 수 있습니다. 

---

> [!NOTE] 25페이지 – 데이터 가공: BMI 계산 공식
> 
> 분석을 하려는데 자료에 **BMI**나 **비만 그룹** 변수가 없다면 어떻게 할까요? 직접 만들어야 합니다.  SPSS의 **'변수 계산'** 기능을 활용합니다. 
> 
> > [!LIST] 📝 BMI 산출 공식 (Syntax)
> > * **공식:** `COMPUTE bmi = wt / ((ht / 100)**2).` 
> > * **설명:** **체중(kg)**을 **신장(m)의 제곱**으로 나눕니다.  자료의 키가 cm 단위라면 반드시 **100**으로 나누어 미터(m)로 변환해야 함을 잊지 마세요. 

---

> [!NOTE] 26-27페이지 – 연속변수의 범주화 (BMI Grouping)
> 
> 계산된 연속형 BMI를 그대로 쓸 수도 있지만, 임상적 해석을 위해 **범주형(bmi_g)**으로 변환하는 경우가 많습니다. 
> 
> > [!IMPORTANT] 🔑 BMI 그룹화 기준
> > 1. **저체중 (1):** BMI < **18.5** 
> > 2. **정상 (2):** **18.5** ≤ BMI < **23** 
> > 3. **과체중 (3):** **23** ≤ BMI < **25** 
> > 4. **비만 (4):** BMI ≥ **25** 
> 
> > [!TIP] ⭐️ 실무 포인트
> > SPSS **'변수 계산'** 창에서 **[조건]** 버튼을 눌러 각 범위에 해당하는 케이스만 선택하여 값을 부여하면 됩니다.  이 과정이 정확해야 최종 로지스틱 분석 결과도 신뢰할 수 있습니다. 

